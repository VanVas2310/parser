from bs4 import BeautifulSoup # —ç—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML
import requests # —ç—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
import json # —ç—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ JSON
import re # —ç—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏

def main():
    print("=== –ü–ê–†–°–ï–† –ù–û–í–û–°–¢–ï–ô ===")
    
    # –°–∫–∞—á–∏–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
    url = "https://web.archive.org/web/20230903112115/https://iz.ru/news"
    response = requests.get(url) # —Å–∫–∞—á–∏–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
    soup = BeautifulSoup(response.content, 'html.parser') # –ø–∞—Ä—Å–∏–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –ø–æ–º–æ—â—å—é BeautifulSoup
    
    # –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
    categories = {
        "–ü–æ–ª–∏—Ç–∏–∫–∞": [],
        "–û–±—â–µ—Å—Ç–≤–æ": [],
        "–≠–∫–æ–Ω–æ–º–∏–∫–∞": [],
        "–°–ø–æ—Ä—Ç": [],
        "–ó–¥–æ—Ä–æ–≤—å–µ": [],
        "–ö—É–ª—å—Ç—É—Ä–∞": [],
        "–ü—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è": [],
        "–ù–∞—É–∫–∞ –∏ —Ç–µ—Ö–Ω–∏–∫–∞": []
    }
    
    # –ò—â–µ–º –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    # –Ω–∞—Ö–æ–¥–∏–º –≤—Å–µ —Ç–µ–≥–∏ <a> —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º href
    all_links = soup.find_all('a', href=True) 
    



    # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é —Å—Å—ã–ª–∫—É
    for link in all_links: 
        title = link.get_text(strip=True) # –ø–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç —Å—Å—ã–ª–∫–∏, —É–±–∏—Ä–∞—è –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã —á–µ—Ä–µ–∑ strip=True
        href = link.get('href', '') # –ø–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ href, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç, —Ç–æ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
        
        # –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
        if len(title) < 20:
            continue
            
        # –§–∏–ª—å—Ç—Ä—É–µ–º –Ω–µ–Ω—É–∂–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        unwanted_words = ['—á–∏—Ç–∞—Ç—å', '–¥–∞–ª–µ–µ', '–∏–∑–≤–µ—Å—Ç–∏—è', '–≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏', '–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ', 
                         '—Å–æ–≥–ª–∞—à–µ–Ω–∏–µ', '—ç–ª ‚Ññ', '—Ñ—Å 77', '–ø–æ—á—Ç–∞', 'rkn.gov.ru', '—Ä–µ–∫–ª–∞–º–∞']
        if any(word in title.lower() for word in unwanted_words):
            continue
            
        # –§–∏–ª—å—Ç—Ä—É–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–∞–∑–¥–µ–ª—ã —Å–∞–π—Ç–∞
        if any(domain in href for domain in ['rkn.gov.ru', 'agreement.html', 'rubric/']):
            continue
        
        # –û—á–∏—â–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–æ–±–µ–ª—ã
        clean_title = clean_title_text(title)
        
        if len(clean_title) < 20:
            continue
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É
        category = get_category(clean_title)
        
        # –û—á–∏—â–∞–µ–º —Å—Å—ã–ª–∫—É –æ—Ç –∞—Ä—Ö–∏–≤–∞
        clean_link = clean_url(href)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ—Å—Ç—å –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é
        if clean_link and clean_link.startswith('https://iz.ru'): # —É—á–∏—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ iz.ru
            news_item = { # —Å–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å —Å –Ω–æ–≤–æ—Å—Ç—å—é
                'title': clean_title, # –æ—á–∏—â–µ–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
                'link': clean_link # –æ—á–∏—â–µ–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞
            }
            categories[category].append(news_item) # –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ—Å—Ç—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é




    
    # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
    for category in categories: 
        unique_news = [] 
        seen_titles = set() # –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
        for news in categories[category]: 
            # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            normalized_title = news['title'].lower().replace(' ', '')
            if normalized_title not in seen_titles: # –µ—Å–ª–∏ —Ç–∞–∫–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –µ—â–µ –Ω–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ
                seen_titles.add(normalized_title) # –æ—Ç–º–µ—á–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞–∫ —É–≤–∏–¥–µ–Ω–Ω—ã–π
                unique_news.append(news) # –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ—Å—Ç—å –≤ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫
        categories[category] = unique_news # –æ–±–Ω–æ–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –Ω–æ–≤–æ—Å—Ç—è–º–∏
    
    # –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–º–æ-–Ω–æ–≤–æ—Å—Ç–∏ –¢–û–õ–¨–ö–û –≤ –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    for category_name, news_list in categories.items():
        if not news_list:
            news_list.append({
                'title': f'–ü—Ä–∏–º–µ—Ä –Ω–æ–≤–æ—Å—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ {category_name}',
                'link': 'https://iz.ru'
            })
    
    # –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    print("\n" + "="*50)
    print("–†–ï–ó–£–õ–¨–¢–ê–¢–´:")
    print("="*50)
    
    total_news = 0
    for category, news_list in categories.items(): # –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –∏—Ö –Ω–æ–≤–æ—Å—Ç–∏
        print(f"\nüìÅ {category} ({len(news_list)} –Ω–æ–≤–æ—Å—Ç–µ–π):") 
        for i, news in enumerate(news_list, 1): # –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –Ω–æ–≤–æ—Å—Ç–∏ —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π, enumerate –¥–µ–ª–∞–µ—Ç –Ω—É–º–µ—Ä–∞—Ü–∏—é —Å 1
            print(f"  {i}. {news['title']}") # –≤—ã–≤–æ–¥–∏–º –Ω–æ–º–µ—Ä –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏
            if news['link'] != 'https://iz.ru': # –Ω–µ –≤—ã–≤–æ–¥–∏–º —Å—Å—ã–ª–∫—É –¥–ª—è –¥–µ–º–æ-–Ω–æ–≤–æ—Å—Ç–µ–π
                print(f"     üîó {news['link']}")
        total_news += len(news_list)
    
    print(f"\nüìä –ò–¢–û–ì–û: {len(categories)} —Ä–∞–∑–¥–µ–ª–æ–≤, {total_news} –Ω–æ–≤–æ—Å—Ç–µ–π")
    



    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ JSON
    with open('news_results.json', 'w', encoding='utf-8') as f: 
        json.dump(categories, f, ensure_ascii=False, indent=2) # —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–ª–æ–≤–∞—Ä—å –≤ —Ñ–∞–π–ª news_results.json —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏ –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
    print("üíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ 'news_results.json'")





def clean_title_text(title):
    """–û—á–∏—â–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã"""
    # –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —Å–ª–∏–ø—à–∏–µ—Å—è —Å–ª–æ–≤–∞ (–û–±—â–µ—Å—Ç–≤–æ–í -> –û–±—â–µ—Å—Ç–≤–æ –í)
    title = re.sub(r'([–∞-—è])([–ê-–Ø])', r'\1 \2', title) # –¥–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–±–µ–ª –º–µ–∂–¥—É —Å—Ç—Ä–æ—á–Ω–æ–π –∏ –∑–∞–≥–ª–∞–≤–Ω–æ–π –±—É–∫–≤–æ–π
    
    # –£–±–∏—Ä–∞–µ–º –≤—Ä–µ–º—è –≤ –∫–æ–Ω—Ü–µ (13:15)
    title = re.sub(r'\d{1,2}:\d{2}$', '', title) 
    
    # –£–±–∏—Ä–∞–µ–º –¥–∞—Ç—ã –≤ –∫–æ–Ω—Ü–µ (3 —Å–µ–Ω—Ç—è–±—Ä—è 2023, 13:03)
    title = re.sub(r'\d{1,2}\s+[–∞-—è]+\s+\d{4}.*$', '', title)
    
    # –£–±–∏—Ä–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Å—ã–ª–∫–∏
    title = re.sub(r'\?main_click$', '', title) # —ç—Ç–æ —á–∞—Å—Ç—å URL-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∏–ª–∏ —Ç—Ä–µ–∫–∏–Ω–≥–æ–≤–∞—è –º–µ—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ‚Äë–æ—à–∏–±–∫–µ –ø–æ–ø–∞–ª–∞ –≤ —Ç–µ–∫—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞.    
    # —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –ø—Ä–æ–±–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (–ø—Ä–æ–±–µ–ª—ã, –ø–µ—Ä–µ–≤–æ–¥—ã —Å—Ç—Ä–æ–∫, —Ç–∞–±—É–ª—è—Ü–∏–∏)
    return title.strip()




def get_category(title): 
    """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –Ω–æ–≤–æ—Å—Ç–∏ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É"""
    title_lower = title.lower() 
    
    # –£–ª—É—á—à–µ–Ω–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    politics_words = [
        '–ø—É—Ç–∏–Ω', '–ø—Ä–µ–∑–∏–¥–µ–Ω—Ç', '–ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ', '–≥–æ—Å–¥—É–º–∞', '–ø–∞—Ä–ª–∞–º–µ–Ω—Ç', '–¥–µ–ø—É—Ç–∞—Ç', 
        '–º–∏–Ω–∏—Å—Ç—Ä', '–≤–ª–∞—Å—Ç—å', '–≤—ã–±–æ—Ä—ã', '–∫–∞–º–ø–∞–Ω–∏—è', '–º—ç—Ä', '–æ–ø–ø–æ–∑–∏—Ü–∏—è', '–∫–æ–∞–ª–∏—Ü–∏—è',
        '–¥–∏–ø–ª–æ–º–∞—Ç', '—Å–∞–Ω–∫—Ü–∏–∏', '—Å–æ–≤–µ—Ç', '–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π', '—Ä–µ—Å–ø—É–±–ª–∏–∫–∞', '–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ',
        '–ø–æ–ª–∏—Ç–∏–∫–∞', '–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è', '–ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–µ–Ω–Ω—ã–π', '—Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π', '—Ä–µ–≥–∏–æ–Ω',
        '–≥—É–±–µ—Ä–Ω–∞—Ç–æ—Ä', '–ø–æ—Å–æ–ª', '–¥–æ–≥–æ–≤–æ—Ä', '—Å–æ–≥–ª–∞—à–µ–Ω–∏–µ', '–≤—Å—Ç—Ä–µ—á–∞', '–ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã',
        '—Å–∞–º–º–∏—Ç', '–∫–æ–Ω–≥—Ä–µ—Å—Å', '—Å–µ–Ω–∞—Ç', '–ø–æ–ª–∏—Ç–∏–∫', '–ª–∏–¥–µ—Ä', '–ø–∞—Ä—Ç–∏—è', '–≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ',
        '–ø–æ—Å–æ–ª—å—Å—Ç–≤–æ', '–∑–µ–ª–µ–Ω—Å–∫–∏–π', '—É–∫—Ä–∞–∏–Ω', '–Ω–∞—Ç–æ', '—Å–≤–æ', '—Å–ø–µ—Ü–æ–ø–µ—Ä–∞—Ü–∏—è', '–≤—Å—É'
    ]
    
    economy_words = [
        '—ç–∫–æ–Ω–æ–º–∏–∫–∞', '—Ä—É–±–ª—å', '–¥–æ–ª–ª–∞—Ä', '–µ–≤—Ä–æ', '–±–∏–∑–Ω–µ—Å', '–∏–Ω—Ñ–ª—è—Ü–∏—è', '–±–∞–Ω–∫', 
        '–∫—É—Ä—Å', '—Ä—ã–Ω–æ–∫', '–∫–æ–º–ø–∞–Ω–∏—è', '–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏', '–∞–∫—Ü–∏—è', '—Ç–æ—Ä–≥–∏', '–ø—Ä–∏–±—ã–ª—å',
        '—É–±—ã—Ç–æ–∫', '–Ω–∞–ª–æ–≥', '–≤–≤–ø', '–¥–µ—Ñ–ª—è—Ü–∏—è', '—Ä–µ—Ü–µ—Å—Å–∏—è', '—Å–µ–∫—Ç–æ—Ä', '–æ—Ç—Ä–∞—Å–ª—å',
        '—Ñ–∏–Ω–∞–Ω—Å—ã', '–±—é–¥–∂–µ—Ç', '–¥–æ—Ö–æ–¥', '—Ä–∞—Å—Ö–æ–¥', '–∑–∞—Ä–ø–ª–∞—Ç–∞', '–ø–µ–Ω—Å–∏—è', '—Ü–µ–Ω—ã',
        '–∏–Ω—Ñ–ª—è—Ü–∏—è', '–∫—Ä–∏–∑–∏—Å', '—Ä–æ—Å—Ç', '—Å–Ω–∏–∂–µ–Ω–∏–µ', '–ø—Ä–æ—Ü–µ–Ω—Ç', '—Å—Ç–∞–≤–∫–∞', '–∫—Ä–µ–¥–∏—Ç',
        '–º–∏–ª–ª–∏–∞—Ä–¥', '–º–∏–ª–ª–∏–æ–Ω', '—Ä—É–±–ª–µ–π', '–¥–æ–ª–ª–∞—Ä–æ–≤', '–µ–≤—Ä–æ', '–¥–µ–¥–æ–ª–ª–∞—Ä–∏–∑–∞—Ü–∏—è',
        '–±–∏–∑–Ω–µ—Å–º–µ–Ω', '–∫–æ–ª–æ–º–æ–π—Å–∫–∏–π', '–∞—ç—Ä–æ–ø–æ—Ä—Ç', '–ø–æ–¥–¥–µ—Ä–∂–∫', '—Ñ–∏–Ω–∞–Ω—Å'
    ]
    
    sport_words = [
        '—Å–ø–æ—Ä—Ç', '—Ñ—É—Ç–±–æ–ª', '—Ö–æ–∫–∫–µ–π', '–±–∞—Å–∫–µ—Ç–±–æ–ª', '—Ç–µ–Ω–Ω–∏—Å', '–æ–ª–∏–º–ø–∏–∞–¥–∞', '—á–µ–º–ø–∏–æ–Ω–∞—Ç',
        '–º–∞—Ç—á', '–∏–≥—Ä–∞', '–≥–æ–ª', '—Å—á–µ—Ç', '–ø–æ–±–µ–¥–∞', '–ø–æ—Ä–∞–∂–µ–Ω–∏–µ', '–∫–æ–º–∞–Ω–¥–∞', '–∏–≥—Ä–æ–∫',
        '—Ç—Ä–µ–Ω–µ—Ä', '—Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ', '—Ç—É—Ä–Ω–∏—Ä', '–º–µ–¥–∞–ª—å', '—Ä–µ–∫–æ—Ä–¥', '—Å—Ç–∞–¥–∏–æ–Ω', '–∞—Ä–µ–Ω–∞',
        '–ª–∏–≥–∞', '–∫—É–±–æ–∫', '—Ñ–∏–Ω–∞–ª', '–ø–æ–ª—É—Ñ–∏–Ω–∞–ª', '—á–µ–º–ø–∏–æ–Ω', '–ø—Ä–∏–∑–µ—Ä', '–∞—Ç–ª–µ—Ç', '–±–µ–≥',
        '–ø–ª–æ–≤–µ—Ü', '–≥–∏–º–Ω–∞—Å—Ç', '–±–æ–∫—Å', '–µ–¥–∏–Ω–æ–±–æ—Ä—Å—Ç–≤–∞', '–∞–≤—Ç–æ—Å–ø–æ—Ä—Ç', '–≤–µ–ª–æ—Å–ø–æ—Ä—Ç',
        '–º–µ–¥–≤–µ–¥–µ–≤', '—Å–±–æ—Ä–Ω–∞—è', '–∫–∞—Ç–∞—Ä', '—Ç–æ–≤–∞—Ä–∏—â–µ—Å–∫–∏–π', '—á–µ—Ç–≤–µ—Ä—Ç—ã–π –∫—Ä—É–≥'
    ]
    
    health_words = [
        '–∑–¥–æ—Ä–æ–≤—å–µ', '–º–µ–¥–∏—Ü–∏–Ω–∞', '–≤—Ä–∞—á', '–±–æ–ª—å–Ω–∏—Ü–∞', '–∫–ª–∏–Ω–∏–∫–∞', '–ø–∞—Ü–∏–µ–Ω—Ç', '–ª–µ—á–µ–Ω–∏–µ',
        '–¥–∏–∞–≥–Ω–æ–∑', '–±–æ–ª–µ–∑–Ω—å', '–∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ', '–≤–∏—Ä—É—Å', '–∏–Ω—Ñ–µ–∫—Ü–∏—è', '—ç–ø–∏–¥–µ–º–∏—è', 
        '–ø–∞–Ω–¥–µ–º–∏—è', '–≤–∞–∫—Ü–∏–Ω–∞', '–ø—Ä–∏–≤–∏–≤–∫–∞', '–∞–ø—Ç–µ–∫–∞', '–ª–µ–∫–∞—Ä—Å—Ç–≤–æ', '—Ç–∞–±–ª–µ—Ç–∫–∏', 
        '–æ–ø–µ—Ä–∞—Ü–∏—è', '—Ö–∏—Ä—É—Ä–≥', '—Ç–µ—Ä–∞–ø–∏—è', '—Ä–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è', '–ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞', '–¥–∏–µ—Ç–∞',
        '–ø–∏—Ç–∞–Ω–∏–µ', '–≤–∏—Ç–∞–º–∏–Ω—ã', '–∏–º–º—É–Ω–∏—Ç–µ—Ç', '–∞–Ω–∞–ª–∏–∑', '–æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ', '—Å–∏–º–ø—Ç–æ–º',
        '—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞', '–¥–∞–≤–ª–µ–Ω–∏–µ', '—Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω', '–¥–∏–∞–±–µ—Ç', '—Ä–∞–∫', '—Å–µ—Ä–¥—Ü–µ',
        '–æ–Ω–∫–æ–ª–æ–≥', '—Å–º–µ—Ä—Ç—å', '—Å–∏–º–ø—Ç–æ–º', '–º–≥–Ω–æ–≤–µ–Ω–Ω', '—Ä–∏—Å–∫'
    ]
    
    culture_words = [
        '–∫—É–ª—å—Ç—É—Ä–∞', '–∏—Å–∫—É—Å—Å—Ç–≤–æ', '–∫–∏–Ω–æ', '—Ç–µ–∞—Ç—Ä', '–º—É–∑–µ–π', '–≥–∞–ª–µ—Ä–µ—è', '–≤—ã—Å—Ç–∞–≤–∫–∞',
        '–∫–æ–Ω—Ü–µ—Ä—Ç', '—Ñ–µ—Å—Ç–∏–≤–∞–ª—å', '–ø—Ä–µ–º–∏—è', '–∞–∫—Ç–µ—Ä', '—Ä–µ–∂–∏—Å—Å–µ—Ä', '—Å—Ü–µ–Ω–∞—Ä–∏–π', '—Ñ–∏–ª—å–º',
        '—Å–ø–µ–∫—Ç–∞–∫–ª—å', '–æ–ø–µ—Ä–∞', '–±–∞–ª–µ—Ç', '–º—É–∑—ã–∫–∞', '–ø–µ—Å–Ω—è', '–∞–ª—å–±–æ–º', '–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å',
        '—Ö—É–¥–æ–∂–Ω–∏–∫', '—Å–∫—É–ª—å–ø—Ç–æ—Ä', '–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä', '–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞', '–∫–Ω–∏–≥–∞', '–ø–∏—Å–∞—Ç–µ–ª—å',
        '–ø–æ—ç—Ç', '—Å—Ç–∏—Ö–∏', '—Ä–æ–º–∞–Ω', '–±–∏–±–ª–∏–æ—Ç–µ–∫–∞', '—á—Ç–µ–Ω–∏–µ', '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ', '—Ç–∞–ª–∞–Ω—Ç',
        '—à—É—Ñ—É—Ç–∏–Ω—Å–∫–∏–π', '—Ö–∏—Ç', '—Å–µ–Ω—Ç—è–±—Ä—å—Å–∫–∏–π', '—Ñ–µ—Å—Ç–∏–≤–∞–ª—å', '–±–æ—Ä–æ–¥–∏–Ω–æ', '–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π'
    ]
    
    incidents_words = [
        '–ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏–µ', '–∞–≤–∞—Ä–∏—è', '–¥—Ç–ø', '–ø–æ–∂–∞—Ä', '–≤–∑—Ä—ã–≤', '–∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞', '—Ç—Ä–∞–≥–µ–¥–∏—è',
        '–ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ', '—É–±–∏–π—Å—Ç–≤–æ', '–æ–≥—Ä–∞–±–ª–µ–Ω–∏–µ', '–∫—Ä–∞–∂–∞', '—Ä–∞–∑–±–æ–π', '–Ω–∞–ø–∞–¥–µ–Ω–∏–µ',
        '–∑–∞–¥–µ—Ä–∂–∞–Ω–∏–µ', '–∞—Ä–µ—Å—Ç', '—Å—É–¥', '–ø–æ–ª–∏—Ü–∏—è', '–º–∏–ª–∏—Ü–∏—è', '—Å–ª–µ–¥—Å—Ç–≤–∏–µ', '—Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ',
        '–ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏–π', '–∂–µ—Ä—Ç–≤–∞', '—Ä–∞–Ω–µ–Ω—ã–π', '–ø–æ–≥–∏–±—à–∏–π', '—Å–ø–∞—Å–µ–Ω–∏–µ', '–º—á—Å', '—Å–∫–æ—Ä–∞—è',
        '—á—Ä–µ–∑–≤—ã—á–∞–π–Ω–∞—è', '—Å–∏—Ç—É–∞—Ü–∏—è', '–∏–Ω—Ü–∏–¥–µ–Ω—Ç', '–∫–æ–Ω—Ñ–ª–∏–∫—Ç', '–¥—Ä–∞–∫–∞', '—Å—Ç—Ä–µ–ª—å–±–∞', '–ø–µ—Ä–µ—Å—Ç—Ä–µ–ª–∫–∞',
        '–ø–æ–∂–∞—Ä', '–∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å', '–ø–µ—Ç–µ—Ä–±—É—Ä–≥', '–ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω', '–Ω–µ—Ñ—Ç–µ–±–∞–∑', '–æ—á–µ–≤–∏–¥—Ü—ã'
    ]
    
    science_words = [
        '–Ω–∞—É–∫–∞', '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ', '—É—á–µ–Ω—ã–π', '–æ—Ç–∫—Ä—ã—Ç–∏–µ', '–∏–∑–æ–±—Ä–µ—Ç–µ–Ω–∏–µ',
        '—Ä–æ–±–æ—Ç', '–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π', '–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç', '–∫–æ—Å–º–æ—Å', '–∫–æ—Å–º–∏—á–µ—Å–∫–∏–π', '—Ä–∞–∫–µ—Ç–∞',
        '—Å–ø—É—Ç–Ω–∏–∫', '–º–∞—Ä—Å', '–ª—É–Ω–∞', '–≥–∞–ª–∞–∫—Ç–∏–∫–∞', '–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è', '—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç',
        '–∞–Ω–∞–ª–∏–∑', '–¥–∞–Ω–Ω—ã–µ', '–ø—Ä–æ–≥—Ä–∞–º–º–∞', '—Å–æ—Ñ—Ç', '–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', '–≥–∞–¥–∂–µ—Ç', '—Å–º–∞—Ä—Ç—Ñ–æ–Ω',
        '–∫–æ–º–ø—å—é—Ç–µ—Ä', '–∏–Ω—Ç–µ—Ä–Ω–µ—Ç', '—Ü–∏—Ñ—Ä–æ–≤–æ–π', '–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π', '—Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å', '–±–∏—Ç–∫–æ–∏–Ω',
        '–∫—Ä–∏–ø—Ç–æ', '–±–ª–æ–∫—á–µ–π–Ω', '–Ω–∞–Ω–æ', '–≥–µ–Ω', '–¥–Ω–∫', '–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', '–±–∏–æ–ª–æ–≥–∏—è',
        '–∏–Ω—Ç–µ—Ä–Ω–µ—Ç', '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏', 'it', '–∞–π—Ç–∏'
    ]
    
    society_words = [
        '–æ–±—â–µ—Å—Ç–≤–æ', '–≥–æ—Ä–æ–¥', '–∂–∏—Ç–µ–ª–∏', '—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', '—à–∫–æ–ª–∞', '—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç',
        '—Å—Ç—É–¥–µ–Ω—Ç', '—É—á–∏—Ç–µ–ª—å', '–¥–µ—Ç—Å–∫–∏–π', '—Å–µ–º—å—è', '–¥–µ—Ç–∏', '—Ä–æ–¥–∏—Ç–µ–ª–∏', '–ø–µ–Ω—Å–∏–æ–Ω–µ—Ä',
        '–º–æ–ª–æ–¥–µ–∂—å', '–≤–µ—Ç–µ—Ä–∞–Ω', '–ø—Ä–∞–∑–¥–Ω–∏–∫', '—Ç—Ä–∞–¥–∏—Ü–∏—è', '–æ–±—ã—á–∞–π', '—Ä–µ–ª–∏–≥–∏—è', '—Ü–µ—Ä–∫–æ–≤—å',
        '—Ö—Ä–∞–º', '–º–µ—á–µ—Ç—å', '—Å–∏–Ω–∞–≥–æ–≥–∞', '–±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–≤–æ–ª–æ–Ω—Ç–µ—Ä', '–ø–æ–º–æ—â—å',
        '—Å–æ—Ü–∏–∞–ª—å–Ω—ã–π', '–ø—Ä–æ–≥—Ä–∞–º–º–∞', '–ø—Ä–æ–µ–∫—Ç', '—Ä–∞–∑–≤–∏—Ç–∏–µ', '–±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ', '—ç–∫–æ–ª–æ–≥–∏—è',
        '–ø—Ä–∏—Ä–æ–¥–∞', '–æ–∫—Ä—É–∂–∞—é—â–∞—è —Å—Ä–µ–¥–∞', '–∫–ª–∏–º–∞—Ç', '–ø–æ–≥–æ–¥–∞', '—à—Ç–æ—Ä–º', '–ª–∏–≤–µ–Ω—å', '–≤–µ—Ç–µ—Ä',
        '–º–µ–º–æ—Ä–∏–∞–ª', '–≥–µ—Ä–æ–π', '–±–µ—Å–ª–∞–Ω', '—Ç–µ—Ä–∞–∫—Ç', '–ª–∏—Ç—É—Ä–≥–∏—è', '–∂–µ—Ä—Ç–≤', '–∑–∞–±–∞–π–∫–∞–ª—å—Å–∫',
        '—Å–æ—á–∏', '–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ', '–æ—Ä–µ–Ω–±—É—Ä–∂—å–µ', '–±—É—Ä—è—Ç–∏—è', '–Ω–µ—Ñ—Ä–∏—Ç'
    ]
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
    if any(word in title_lower for word in politics_words):
        return "–ü–æ–ª–∏—Ç–∏–∫–∞"
    elif any(word in title_lower for word in economy_words):
        return "–≠–∫–æ–Ω–æ–º–∏–∫–∞"
    elif any(word in title_lower for word in sport_words):
        return "–°–ø–æ—Ä—Ç"
    elif any(word in title_lower for word in health_words):
        return "–ó–¥–æ—Ä–æ–≤—å–µ"
    elif any(word in title_lower for word in culture_words):
        return "–ö—É–ª—å—Ç—É—Ä–∞"
    elif any(word in title_lower for word in incidents_words):
        return "–ü—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è"
    elif any(word in title_lower for word in science_words):
        return "–ù–∞—É–∫–∞ –∏ —Ç–µ—Ö–Ω–∏–∫–∞"
    elif any(word in title_lower for word in society_words):
        return "–û–±—â–µ—Å—Ç–≤–æ"
    else:
        return "–û–±—â–µ—Å—Ç–≤–æ"






def clean_url(url):
    """–û—á–∏—â–∞–µ—Ç URL –æ—Ç –∞—Ä—Ö–∏–≤–∞ –∏ –¥–µ–ª–∞–µ—Ç –ø–æ–ª–Ω—É—é —Å—Å—ã–ª–∫—É"""
    if not url: # –µ—Å–ª–∏ —Å—Å—ã–ª–∫–∞ –ø—É—Å—Ç–∞—è
        return "" # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
    
    # –£–±–∏—Ä–∞–µ–º —á–∞—Å—Ç—å –∞—Ä—Ö–∏–≤–∞
    if '/web/20230903112115/' in url: 
        url = url.replace('/web/20230903112115/', '') 
    
    # –î–µ–ª–∞–µ–º –ø–æ–ª–Ω—É—é —Å—Å—ã–ª–∫—É
    if url.startswith('/'): # –µ—Å–ª–∏ —Å—Å—ã–ª–∫–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è
        return f"https://iz.ru{url}" # –¥–æ–±–∞–≤–ª—è–µ–º –¥–æ–º–µ–Ω iz.ru
    elif url.startswith('http'): # –µ—Å–ª–∏ —Å—Å—ã–ª–∫–∞ —É–∂–µ –ø–æ–ª–Ω–∞—è
        return url # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å
    else: 
        return ""

if __name__ == "__main__": 
    main()
